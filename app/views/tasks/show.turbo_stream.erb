<% 
  current_value = @task.taskable.value.to_i
  total_cells = 100
  filled_cells = [current_value, total_cells].min
  progress_percentage = (filled_cells.to_f / total_cells * 100).round(1)
  task_emoji = @task.emoji.present? ? @task.emoji : 'â­'
%>

<%= turbo_stream.replace "progress-stats" do %>
  <%= render 'progress_stats', task: @task, current_value: current_value, filled_cells: filled_cells, progress_percentage: progress_percentage %>
<% end %>

<%= turbo_stream.replace "achievement-grid-container" do %>
  <%= render 'achievement_grid', task: @task, current_value: current_value, filled_cells: filled_cells, task_emoji: task_emoji %>
<% end %>

<%= turbo_stream.replace "recent-activity" do %>
  <% recent_entries = @task.entries.order(created_at: :desc).limit(5) %>
  <%= render 'recent_activity', recent_entries: recent_entries %>
<% end %>
